<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>

    <!-- Style CSS Links -->
    <link rel="stylesheet" href="{{ asset('assets/plugins/bootstrap/css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/css/core.css') }}">

    <!-- Javascript Implementation -->
    <script src="{{ asset('assets/plugins/bootstrap/js/bootstrap.min.js') }}"></script>
    <script src="{{ asset('assets/js/jquery.min.js') }}"></script>
</head>
<body>

    <div class="container">
        <div class="text-center">
            <h1 class="app-title">‚èæ Sleep Disorder App</h1>
        </div>

        <div class="row d-flex align-items-center justify-content-between main-row-div">
           <div class="col-5">
               <div class="card card-shadow w-100">
                   <div class="card-body">
                       <form class="form" id="analyze-form">
                           <div class="row">
                               <div class="col">
                                   <div class="mb-5">
                                       <label for="gender-select" class="form-label fw-bold">üë§ Gender</label>
                                       <select class="form-select" id="gender-select" name="gender">
                                           <option value="male">Male</option>
                                           <option value="female">Female</option>
                                       </select>
                                   </div>
                               </div>


                               <div class="col">
                                   <div class="mb-5">
                                       <label for="age-input" class="form-label fw-bold">üìÜ Age</label>
                                       <input type="number" class="form-control" id="age-input" name="age" />
                                   </div>
                               </div>
                           </div>


                           <div class="mb-5">
                               <label for="job-input" class="form-label fw-bold">üîó Job</label>
                               <input type="text" class="form-control" id="job-input" name="job" placeholder="Software Engineer" />
                           </div>


                           <div class="row">
                               <div class="col">
                                   <div class="mb-5">
                                       <label for="sleep-duration-input" class="form-label fw-bold">‚òæ Sleep Duration</label>
                                       <input type="number" step=".1" class="form-control" id="sleep-duration-input" name="sleep_duration" />
                                   </div>
                               </div>


                               <div class="col">
                                   <div class="mb-5">
                                       <label for="night-awakenings-input" class="form-label fw-bold">‚òΩ Night Awakenings</label>
                                       <input type="number" class="form-control" id="night-awakenings-input" name="night_awakenings" />
                                   </div>
                               </div>
                           </div>

                           <div class="mb-5">
                               <label for="sleep-quality-input" class="form-label fw-bold">‚û°Ô∏è Sleep Quality</label>
                               <div class="d-flex w-100 gap-2">
                                   <input type="range" min="1" max="10" value="5" class="form-control" id="sleep-quality-input" name="sleep_quality" aria-describedby="sleep-quality-help" />
                                   <output for="sleep-quality-input" id="sleep-quality-range-value" aria-hidden="true"></output>
                               </div>
                               <div id="sleep-quality-help" class="form-text">‚ÑπÔ∏è Rate how restful your sleep felt overall.</div>
                           </div>


                           <div class="mb-5">
                               <label for="short-life-description" class="form-label fw-bold">Short Life Description</label>
                               <textarea class="form-control" id="short-life-description" rows="3" maxlength="500" aria-describedby="short-life-description-life"></textarea>
                               <div id="short-life-description-info" class="form-text">‚ÑπÔ∏è Briefly describe your daily routine (maximum 500 characters).</div>
                           </div>

                           <button class="btn btn-dark mt-1 w-100" type="button" id="analyze-button" onclick="analyze()">Analyze</button>
                       </form>
                   </div>
               </div>
           </div>


            <div class="col-5 d-flex justify-content-center app-description-main-div">
                <div>
                    <div>
                        <img src="{{ asset('assets/images/app-description-image.jpg') }}" class="w-100">
                    </div>

                    <div class="app-description-list-item">üåô This app helps you gain insights into your sleep quality.</div>
                    <div class="app-description-list-item">ü§ñ The collected sleep data is analyzed by an advanced AI model.</div>
                    <div class="app-description-list-item">üìä The analysis process is based on a scientifically designed dataset structure.</div>
                    <div class="app-description-list-item">üí§ Your personal sleep pattern, night awakenings and total sleep duration are evaluated to analyze your sleep quality.</div>
                    <div class="app-description-list-item">üìà With this app, you can receive AI-powered suggestions to improve your sleep quality.</div>
                    <div class="app-description-list-item">üîí The information you enter is used only for analysis purposes.</div>
                </div>
            </div>
        </div>

        <div id="response-div" class="mt-3 card p-2 d-none"></div>
    </div>


    <div id="analyzing-your-sleep-main-div" class="d-none">
        <div class="loader-main-div">
            <span class="loader"></span>
        </div>

        <div class="mt-3 analyzing-your-sleep-text">‚èæ Analyzing your sleep ‚èæ</div>
    </div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.serializeJSON/3.2.1/jquery.serializejson.min.js" integrity="sha512-SdWDXwOhhVS/wWMRlwz3wZu3O5e4lm2/vKK3oD0E5slvGFg/swCYyZmts7+6si8WeJYIUsTrT3KZWWCknSopjg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    // This is an example script, please modify as needed
    const rangeInput = document.getElementById('sleep-quality-input');
    const rangeOutput = document.getElementById('sleep-quality-range-value');

    // Set initial value
    rangeOutput.textContent = rangeInput.value;

    rangeInput.addEventListener('input', function() {
        rangeOutput.textContent = this.value;
    });

    analyze = () => {
        let responseDiv = $("#response-div");
        responseDiv.addClass("d-none");

        var analyzingYourSleepLoaderDiv = $("#analyzing-your-sleep-main-div");
        analyzingYourSleepLoaderDiv.removeClass("d-none");

        var formData = $("#analyze-form").serializeJSON();
        formData.short_life_description = $("#short-life-description").val();

        $.ajax({
            'url' : '{{ path('sleep_analyze') }}',
            'type' : 'POST',
            'data' : formData,
            'success' : function(data) {
                let response = data.response;
                responseDiv.html(response);
                responseDiv.removeClass("d-none");
                analyzingYourSleepLoaderDiv.addClass("d-none");
            },
            'error' : function(request,error) {
                analyzingYourSleepLoaderDiv.addClass("d-none");
            }
        });
    }

</script>
</body>
</html>
